define(["sulusalescore/components/editable-data-row/decorators/address-view","sulusalescore/components/editable-data-row/decorators/simple-view"],function(a,b){"use strict";var c={view:"address",viewOptions:{},instanceName:"undefined",disabled:!1,selectData:null,overlayTitle:null,showPlusIcon:!0},d={address:a,simple:b},e={overlayContainerClass:"edit-data-overlay",overlayContainerClassSelector:".edit-data-overlay",rowClassSelector:".editable-row",addClass:"add-data",overlayFormSelector:"editable-data-overlay-form"},f="sulu.editable-data-row.",g=function(){return f+this.options.instanceName+".initialized"},h=function(){return f+this.options.instanceName+".data.update"},i=function(){return f+this.options.instanceName+".set-value"},j=function(){this.options.disabled||(this.sandbox.on(i.call(this),function(a){this.setSelectedData(a),this.overlayView.render()}.bind(this)),this.sandbox.on(h.call(this),function(a,b){this.setSelectedData(b),this.data=a,this.overlayView.render()}.bind(this)),this.sandbox.on("sulu.editable-data-row."+this.options.instanceName+".overlay.initialize",function(a){a.overlayTemplate||this.sandbox.logger.error("No template for overlay defined!"),"function"!=typeof a.okCallback&&a.okCallback||"function"!=typeof a.closeCallback&&a.closeCallback?this.sandbox.logger.error("Editable-Data-Row: Invalid callbacks for overlay!"):l.call(this,a.overlayTemplate,a.overlayTitle,a.overlayOkCallback,a.overlayCloseCallback,a.overlayData)}.bind(this)))},k=function(){this.sandbox.dom.on(this.$el,"click",function(){this.data&&this.overlayView.openOverlay()}.bind(this),"."+e.addClass)},l=function(a,b,c,d,f){var g,h,i;this.sandbox.stop(this.sandbox.dom.find(e.overlayContainerClassSelector,this.$el)),this.sandbox.dom.remove(this.sandbox.dom.find(e.overlayContainerClassSelector,this.$el)),g=this.sandbox.dom.createElement('<div class="'+e.overlayContainerClass+'"></div>'),this.sandbox.dom.append(this.$el,g),i={data:f,translate:this.sandbox.translate,instanceName:this.overlayView.options.instanceName},h=this.sandbox.util.template(a,i),this.sandbox.start([{name:"overlay@husky",options:{el:g,title:this.sandbox.translate(b),openOnStart:!0,removeOnClose:!1,skin:"wide",instanceName:this.options.instanceName,data:h,okCallback:c?c.bind(this):null,closeCallback:d?d.bind(this):null}}])},m=function(){var a;this.options.disabled||(a=this.sandbox.dom.createElement('<i class="fa fa-plus-circle pointer '+e.addClass+'"></i>'),this.sandbox.dom.append(this.$el,a))},n=function(a){return!("function"!=typeof a.initialize||"function"!=typeof a.openOverlay||"function"!=typeof a.render)};return{initialize:function(){return this.options=this.sandbox.util.extend({},c,this.options),this.selectedData=this.options.value,this.data=this.options.selectData,this.decorators=this.sandbox.util.extend(!0,{},d),this.viewId=this.options.view,this.overlayView=this.decorators[this.viewId],this.overlayView&&n.call(this,this.overlayView)?(this.options.viewOptions.instanceName=this.options.instanceName,this.overlayView.initialize(this,this.options.viewOptions),j.call(this),k.call(this),this.selectedData?this.render():this.options.showPlusIcon&&m.call(this),void this.sandbox.emit(g.call(this))):void this.sandbox.logger.error("Editable-Data-Row: View is not valid!")},render:function(){this.options.disabled&&(this.sandbox.dom.addClass(this.$el,"disabled"),this.sandbox.dom.addClass(this.$el,"not-clickable")),this.overlayView.render()},setSelectedData:function(a){var b=this.sandbox.dom.find("."+e.addClass,this.$el);a&&0!==b.length?this.sandbox.dom.remove(b):a||0!==b.length||m.call(this),this.selectedData=a,this.sandbox.dom.data(this.$el,"value",a)},getDataByPropertyAndValue:function(a,b){var c=null;return this.sandbox.util.each(this.context.data,function(d,e){return e[a].toString()===b.toString()?(c=e,!1):void 0}.bind(this)),c}}});