define(["text!sulusalescore/components/editable-data-row/templates/simple.form.html"],function(a){"use strict";var b={instanceName:"undefined",fields:null,defaultProperty:null,overlayTemplate:null,overlayTitle:"public.edit-entries",selectSelector:"#data-select",propertyName:"name"},c={rowClass:"editable-row",rowClassSelector:".editable-row",formSelector:".editable-data-overlay-form",eventNamespace:"sulu.editable-data-row.simple-view."},d={rowTemplate:function(a,b){return b?['<span class="block ',c.rowClass,' disabled">',a,"</span>"].join(""):['<span class="block pointer ',c.rowClass,'">',a,"</span>"].join("")}},e=function(){this.sandbox.emit(c.eventNamespace+this.options.instanceName+".initialized")},f=function(a){this.sandbox.emit(c.eventNamespace+this.options.instanceName+".changed",a)},g=function(){this.context.options.disabled||(this.sandbox.on("husky.overlay."+this.context.options.instanceName+".opened",function(){this.openedDialog||j.call(this),this.openedDialog=!1}.bind(this)),this.sandbox.on("husky.overlay."+this.context.options.instanceName+".initialized",function(){this.openedDialog=!1}.bind(this)),this.sandbox.on("husky.select."+this.options.instanceName+".select.selected.item",function(a){var b=this.context.getDataByPropertyAndValue.call(this,"id",a);k.call(this,b)}.bind(this)))},h=function(){this.sandbox.emit("husky.overlay."+this.context.options.instanceName+".close"),this.sandbox.emit("sulu.overlay.show-warning","salesorder.orders.addressOverlayWarningTitle","salesorder.orders.addressOverlayWarningMessage",i.bind(this,!1),i.bind(this,!0)),this.openedDialog=!0},i=function(a){if(a){var b=this.sandbox.form.getData(this.formObject,!0),c=b;"object"==typeof b&&(c=this.sandbox.util.extend({},this.context.selectedData,b),b=c[this.options.propertyName]),this.context.setSelectedData(b),f.call(this,this.context.selectedData),n.call(this,this.context.selectedData)}else this.sandbox.emit("husky.overlay."+this.context.options.instanceName+".open")},j=function(){var a=this.sandbox.dom.find(c.formSelector,this.context.$el);this.sandbox.start(this.sandbox.dom.find(".editable-data-overlay-container",this.$el)),this.formObject=this.sandbox.form.create(a),this.formObject.initialized.then(function(){this.context.selectedData&&k.call(this,this.context.selectedData)}.bind(this))},k=function(a){this.sandbox.form.setData(this.formObject,a).fail(function(a){this.sandbox.logger.error("An error occured when setting data!",a)}.bind(this))},l=function(){this.sandbox.emit("sulu.editable-data-row."+this.options.instanceName+".overlay.initialize",{overlayTemplate:a,overlayTitle:this.options.overlayTitle,overlayOkCallback:h.bind(this),overlayCloseCallback:null,overlayData:this.context.data})},m=function(){this.context.options.disabled||(this.sandbox.dom.on(this.context.$el,"click",l.bind(this),c.rowClassSelector),this.sandbox.dom.on(this.context.$el,"change",function(a){var b=this.sandbox.dom.val(a.currentTarget),c=this.context.getDataByPropertyAndValue.call(this,"id",b);k.call(this,c)}.bind(this),this.options.selectSelector))},n=function(a){var b,e;e=this.sandbox.dom.find(c.rowClassSelector,this.context.$el),this.sandbox.dom.remove(e),a&&(b=this.sandbox.dom.createElement(d.rowTemplate(a,this.context.options.disabled)),this.sandbox.dom.append(this.context.$el,b))};return{initialize:function(a,c){this.context=a,this.sandbox=this.context.sandbox,this.options=this.sandbox.util.extend({},b,c),this.openedDialog=!1,g.call(this),m.call(this),e.call(this)},render:function(){n.call(this,this.context.selectedData)},openOverlay:function(){l.call(this)}}});